schema: '2.0'
stages:
  prepare:
    cmd: python -m src.salary.prepare --test-size 0.3 --seed 42
    deps:
    - path: data/raw/advanced_plus_totals
      hash: md5
      md5: 97f2c483556f6f4d761b6ebd769294f4.dir
      size: 2902566
      nfiles: 13
    - path: src/salary/consts.py
      hash: md5
      md5: 3bfb341c9bcb174f72a270fd4c82d753
      size: 960
    - path: src/salary/prepare.py
      hash: md5
      md5: 95682eb7e98f6c2a4c0730fc4b5b19c0
      size: 1767
    - path: src/salary/utils.py
      hash: md5
      md5: 6952769a0ebff51896903275b40134a3
      size: 3961
    params:
      src/salary/params.py:
        Base.seed: 42
        Preprocessing.test_size: 0.3
    outs:
    - path: data/interim/salary/
      hash: md5
      md5: 2bce899794e96e665743c1e98a981a9d.dir
      size: 912389
      nfiles: 2
  featurize:
    cmd: python -m src.salary.featurize --target SalaryAdj
    deps:
    - path: data/interim/salary
      hash: md5
      md5: 2bce899794e96e665743c1e98a981a9d.dir
      size: 912389
      nfiles: 2
    - path: src/salary/consts.py
      hash: md5
      md5: 3bfb341c9bcb174f72a270fd4c82d753
      size: 960
    - path: src/salary/featurize.py
      hash: md5
      md5: 178c9582e646bf9fab58ac3daf7acbd2
      size: 2375
    - path: src/salary/params.py
      hash: md5
      md5: 8131fbc679bc0d0a8803033b248a6efb
      size: 940
    - path: src/salary/utils.py
      hash: md5
      md5: 6952769a0ebff51896903275b40134a3
      size: 3961
    params:
      src/salary/params.py:
        Base.target: SalaryAdj
    outs:
    - path: dags/salary/preprocessor.pkl
      hash: md5
      md5: 3bdfcc6bb64e09ad938164ff6e8f64ae
      size: 5220
    - path: data/processed/salary/
      hash: md5
      md5: 48e3b4bc486e6781bfa51588f2d19506.dir
      size: 3005070
      nfiles: 2
  train:
    cmd: python -m src.salary.train catboost --target SalaryAdj --seed 42 --metric-name
      r2 --valid-size 0.25 --early-stopping-rounds 100 --n-trials 10 --timeout 1000
    deps:
    - path: data/processed/salary
      hash: md5
      md5: 48e3b4bc486e6781bfa51588f2d19506.dir
      size: 3005070
      nfiles: 2
    - path: src/salary/consts.py
      hash: md5
      md5: 3bfb341c9bcb174f72a270fd4c82d753
      size: 960
    - path: src/salary/train.py
      hash: md5
      md5: 8ec23d6a4270c50cda448bbbc95ea8ed
      size: 4600
    - path: src/salary/utils.py
      hash: md5
      md5: 6952769a0ebff51896903275b40134a3
      size: 3961
    params:
      src/salary/params.py:
        Base.seed: 42
        Base.target: SalaryAdj
        Catboost.early_stopping_rounds: 100
        Catboost.metric_name: r2
        Catboost.n_trials: 10
        Catboost.timeout: 1000
        Catboost.valid_size: 0.25
    outs:
    - path: models/salary/catboost.cbm
      hash: md5
      md5: 72dde84645743d63255b342db0016b9f
      size: 168528
  evaluate:
    cmd: python -m src.salary.evaluate catboost --target SalaryAdj
    deps:
    - path: data/processed/salary/
      hash: md5
      md5: 48e3b4bc486e6781bfa51588f2d19506.dir
      size: 3005070
      nfiles: 2
    - path: models/salary/catboost.cbm
      hash: md5
      md5: 72dde84645743d63255b342db0016b9f
      size: 168528
    - path: src/salary/consts.py
      hash: md5
      md5: 3bfb341c9bcb174f72a270fd4c82d753
      size: 960
    - path: src/salary/evaluate.py
      hash: md5
      md5: e17a5bb5301387d0736b981ab3e67e97
      size: 1020
    - path: src/salary/utils.py
      hash: md5
      md5: 6952769a0ebff51896903275b40134a3
      size: 3961
    params:
      src/salary/params.py:
        Base.target: SalaryAdj
    outs:
    - path: dags/salary/catboost/metrics.json
      hash: md5
      md5: da5cbbd61342dddad9c07fd44f3d022c
      size: 52
  make_onnx:
    cmd: python -m src.salary.make_onnx catboost --target SalaryAdj
    deps:
    - path: dags/salary/preprocessor.pkl
      hash: md5
      md5: 3bdfcc6bb64e09ad938164ff6e8f64ae
      size: 5220
    - path: data/interim/salary/
      hash: md5
      md5: 2bce899794e96e665743c1e98a981a9d.dir
      size: 912389
      nfiles: 2
    - path: models/salary/catboost.cbm
      hash: md5
      md5: 72dde84645743d63255b342db0016b9f
      size: 168528
    - path: src/salary/consts.py
      hash: md5
      md5: 3bfb341c9bcb174f72a270fd4c82d753
      size: 960
    - path: src/salary/make_onnx.py
      hash: md5
      md5: 44b010020e7f6b16dfa970be3d2503ca
      size: 2726
    - path: src/salary/utils.py
      hash: md5
      md5: 6952769a0ebff51896903275b40134a3
      size: 3961
    params:
      src/salary/params.py:
        Base.target: SalaryAdj
    outs:
    - path: models/salary/catboost.onnx
      hash: md5
      md5: 5cff4b10f624b521145548eb303106f5
      size: 535424
